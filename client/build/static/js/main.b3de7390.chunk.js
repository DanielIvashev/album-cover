(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{25:function(e,t,a){},30:function(e,t,a){e.exports=a(44)},35:function(e,t,a){},42:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(17),c=a.n(r),o=(a(35),a(11)),s=a(1),u=a(4),i=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],l=t[1],r=Object(n.useState)(!1),c=Object(s.a)(r,2),o=c[0],u=c[1],i=Object(n.useState)(null),m=Object(s.a)(i,2),d=m[0],b=m[1],p=Object(n.useState)(null),f=Object(s.a)(p,2),h=f[0],v=f[1],E=Object(n.useCallback)((function(e,t,a){l(e),b(t),v(a),localStorage.setItem("userData",JSON.stringify({userId:t,token:e,userName:a}))}),[]),g=Object(n.useCallback)((function(){l(null),b(null),localStorage.removeItem("userData")}),[]);return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&E(e.token,e.userId,e.userName),u(!0)}),[E]),{login:E,logout:g,token:a,userId:d,ready:o,userName:h}},m=a(45),d=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1],c=i().token;return Object(n.useEffect)((function(){r((function(e){return!0}))}),[]),l.a.createElement(m.a,{classNames:"item",in:a,timeout:1e3,mountOnEnter:!0,unmountOnExit:!0},l.a.createElement("div",{className:"container-fluid vh-100 d-flex justify-content-center align-items-center flex-column"},l.a.createElement("h1",{className:"mb-0 text-center"},"to see the covers, click here"),l.a.createElement("svg",{className:"bi bi-arrow-down",width:"2em",height:"2em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},l.a.createElement("path",{fillRule:"evenodd",d:"M4.646 9.646a.5.5 0 01.708 0L8 12.293l2.646-2.647a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 010-.708z",clipRule:"evenodd"}),l.a.createElement("path",{fillRule:"evenodd",d:"M8 2.5a.5.5 0 01.5.5v9a.5.5 0 01-1 0V3a.5.5 0 01.5-.5z",clipRule:"evenodd"})),l.a.createElement(u.b,{to:"/covers",type:"button",className:"btn btn-outline-dark mt-5 ",style:{transition:"0.3s"}},"see"),c?l.a.createElement(u.b,{to:"/create",type:"button",className:"btn btn-outline-dark position-fixed align-self-end",style:{transition:"0.3s",bottom:"1rem"}},"create"):l.a.createElement(u.b,{to:"/auth",type:"button",className:"btn btn-outline-dark position-fixed align-self-end",style:{transition:"0.3s",bottom:"1rem"}},"authorization")))},b=a(3),p=a.n(b),f=a(22),h=a(9);function v(){}var E=Object(n.createContext)({token:null,userId:null,login:v,logout:v,isAuthenticated:!1,userName:null}),g=function(){return l.a.createElement("div",{className:"d-flex w-100 justify-content-center"},l.a.createElement("div",{className:"spinner-border ",role:"status"},l.a.createElement("span",{className:"sr-only"},"Loading...")))},O=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],l=t[1],r=Object(n.useState)(null),c=Object(s.a)(r,2),o=c[0],u=c[1],i=Object(n.useState)(null),m=Object(s.a)(i,2),d=m[0],b=m[1];return{loading:a,request:Object(n.useCallback)(function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r,c,o,s,i=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:"GET",n=i.length>2&&void 0!==i[2]?i[2]:null,r=i.length>3&&void 0!==i[3]?i[3]:{},c=i.length>4&&void 0!==i[4]&&i[4],l(!0),e.prev=5,n&&!c&&(n=JSON.stringify(n),r["Content-Type"]="application/json"),e.next=9,fetch(t,{method:a,body:n,headers:r});case 9:return o=e.sent,e.next=12,o.json();case 12:return s=e.sent,l(!1),b(s.message),e.abrupt("return",s);case 18:throw e.prev=18,e.t0=e.catch(5),l(!1),u(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:o,clearError:Object(n.useCallback)((function(){u(null)}),[]),message:d}},j=function(){return Object(n.useCallback)((function(e){if(e)return l.a.createElement("div",{className:"alert alert-warning alert-dismissible fade show hide m-0 p-0 text-center",role:"alert"},e)}),[])},x=(a(25),a(46)),N=function(e){var t=e.covers;return l.a.createElement(x.a,{component:"div",className:"row align-items-center "},t.map((function(e,t){return l.a.createElement(m.a,{timeout:1e3,classNames:"item",key:t},l.a.createElement("div",{className:"col-8 col-sm-8 col-md-4 col-lg-4 col-xl-2 p-4"},l.a.createElement(u.b,{className:"text-dark",to:"/detail/".concat(e._id)},l.a.createElement("div",{className:"card",style:{cursor:"pointer"}},l.a.createElement("div",{className:"card-body"},l.a.createElement("img",{src:e.filedataName,className:"card-img-top",alt:e.author}))))))})))},w=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],r=t[1],c=O(),o=c.loading,i=c.request,d=Object(n.useContext)(E).token,b=Object(n.useState)(0),v=Object(s.a)(b,2),x=v[0],w=v[1],k=j(),y=Object(n.useState)(null),S=Object(s.a)(y,2),C=S[0],R=S[1],z=Object(n.useState)(!1),I=Object(s.a)(z,2),T=I[0],A=I[1],F=Object(n.useState)(!1),H=Object(s.a)(F,2),B=H[0],M=H[1],q=Object(n.useCallback)(Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i("/covers/","GET",null,{Authorization:"Bearer ".concat(d),skip:"".concat(x)});case 3:if(0!==(t=e.sent).length){e.next=7;break}return A(!0),e.abrupt("return",R(k("there are no more covers here")));case 7:r((function(e){return[].concat(Object(f.a)(e),Object(f.a)(t))})),M(!0),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])}))),[d,i,x,k]);return Object(n.useEffect)((function(){q()}),[q]),0===a.length?l.a.createElement("div",{className:"vh-100 d-flex align-items-center"},l.a.createElement(g,null)):l.a.createElement(m.a,{classNames:"item",in:B,timeout:1e3,mountOnEnter:!0,unmountOnExit:!0},l.a.createElement("div",null,l.a.createElement(u.b,{to:"/",type:"button",className:"btn btn-link text-dark text-left"},l.a.createElement("svg",{className:"bi bi-arrow-left-short",width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},l.a.createElement("path",{fillRule:"evenodd",d:"M7.854 4.646a.5.5 0 010 .708L5.207 8l2.647 2.646a.5.5 0 01-.708.708l-3-3a.5.5 0 010-.708l3-3a.5.5 0 01.708 0z",clipRule:"evenodd"}),l.a.createElement("path",{fillRule:"evenodd",d:"M4.5 8a.5.5 0 01.5-.5h6.5a.5.5 0 010 1H5a.5.5 0 01-.5-.5z",clipRule:"evenodd"})),"go to the main page"),l.a.createElement("div",{className:"container-fluid d-flex flex-wrap flex-column justify-content-center pb-5",style:{minHeight:"100vh",textAlign:"center"}},l.a.createElement(N,{covers:a}),o?l.a.createElement(g,null):null,C,T?null:l.a.createElement("button",{onClick:function(){return w(x+1)},type:"button",className:"btn btn-outline-dark mt-5 ",style:{transition:"0.3s"}},"click"))))},k=a(13),y=a(14),S=a(28),C=a.n(S),R=function(){var e=Object(o.g)(),t=i(),a=t.isAuthenticated,r=t.logout,c=Object(n.useContext)(E),d=O().request,b=Object(n.useState)(null),f=Object(s.a)(b,2),v=f[0],g=f[1],x=j(),N=Object(n.useState)(!1),w=Object(s.a)(N,2),S=w[0],R=w[1],z=Object(n.useState)(!0),I=Object(s.a)(z,2),T=I[0],A=I[1],F=Object(n.useReducer)((function(e,t){return Object(y.a)({},e,{},t)}),{author:"",label:"",date:"",genre:""}),H=Object(s.a)(F,2),B=H[0],M=H[1],q=Object(n.useState)({}),D=Object(s.a)(q,2),J=D[0],L=D[1],P=B.author&&B.label&&B.date&&B.genre&&!T,G=function(e){var t=e.target.name,a=e.target.value;M(Object(k.a)({},t,a))};Object(n.useEffect)((function(){C.a.init(),R(!0)}),[]);var W=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),(n=new FormData).append("author","".concat(B.author)),n.append("label","".concat(B.label)),n.append("date","".concat(B.date)),n.append("genre","".concat(B.genre)),n.append("filedata",J),t.prev=7,t.next=10,d("/covers/create","POST",n,{Authorization:"Bearer ".concat(c.token)},!0);case 10:l=t.sent,t.t0=l.message,t.next="no authorization"===t.t0?14:"wrong mimetype"===t.t0?17:19;break;case 14:return g(x(l.message)),setTimeout((function(){r(),e.push("/")}),7e3),t.abrupt("break",19);case 17:return g(x(l.message)),t.abrupt("break",19);case 19:e.push("/detail/".concat(l.cover._id)),t.next=24;break;case 22:t.prev=22,t.t1=t.catch(7);case 24:case"end":return t.stop()}}),t,null,[[7,22]])})));return function(e){return t.apply(this,arguments)}}();return a&&(r(),e.push("/")),l.a.createElement(m.a,{classNames:"item",in:S,timeout:1e3,mountOnEnter:!0,unmountOnExit:!0},l.a.createElement("div",{className:"container-fluid d-flex flex-column text-center"},l.a.createElement(u.b,{to:"/covers",type:"button",className:"btn btn-link text-dark text-left"},l.a.createElement("svg",{className:"bi bi-arrow-left-short",width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},l.a.createElement("path",{fillRule:"evenodd",d:"M7.854 4.646a.5.5 0 010 .708L5.207 8l2.647 2.646a.5.5 0 01-.708.708l-3-3a.5.5 0 010-.708l3-3a.5.5 0 01.708 0z",clipRule:"evenodd"}),l.a.createElement("path",{fillRule:"evenodd",d:"M4.5 8a.5.5 0 01.5-.5h6.5a.5.5 0 010 1H5a.5.5 0 01-.5-.5z",clipRule:"evenodd"})),"go to the covers list"),l.a.createElement("div",{className:"row"},l.a.createElement("h2",{className:"p-5 col-12"},"CREATE A NEW COVER"),l.a.createElement("form",{onSubmit:W,className:"m-auto pb-5 col-12 col-sm-10 col-md-6 col-lg-6 col-xl-6",encType:"multipart/form-data"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"author"},"author"),l.a.createElement("input",{type:"text",className:"form-control",id:"author","aria-describedby":"emailHelp",value:B.author,name:"author",onChange:G})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"label"},"label"),l.a.createElement("input",{type:"text",className:"form-control",id:"label","aria-describedby":"emailHelp",value:B.label,name:"label",onChange:G})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"date"},"date"),l.a.createElement("input",{type:"text",className:"form-control",id:"date","aria-describedby":"emailHelp",value:B.date,name:"date",onChange:G})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"genre"},"genre"),l.a.createElement("input",{type:"text",className:"form-control",id:"genre","aria-describedby":"emailHelp",value:B.genre,name:"genre",onChange:G})),l.a.createElement("div",{className:"custom-file"},l.a.createElement("input",{type:"file",className:"custom-file-input",id:"customFile",name:"filedata",onChange:function(e){e.target.value.length>0?(L(e.target.files[0]),A(!1)):0===e.target.value.length&&A(!0)}}),l.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"},"Choose file")),l.a.createElement("div",{className:"form-group mt-4"},v),l.a.createElement("button",{type:"submit",disabled:!P,className:"btn btn-outline-dark mt-5",style:{transition:"0.3s",bottom:"1rem"}},"submit")))))},z=function(){var e=Object(o.g)(),t=Object(n.useContext)(E),a=j(),r=Object(n.useState)(null),c=Object(s.a)(r,2),u=c[0],i=c[1],d=O(),b=d.loading,f=d.error,v=d.request,g=Object(n.useState)(!1),x=Object(s.a)(g,2),N=x[0],w=x[1],S=Object(n.useState)({login:"",password:""}),C=Object(s.a)(S,2),R=C[0],z=C[1];Object(n.useEffect)((function(){i(a(f)),w(!0)}),[f,a]);var I=function(e){z(Object(y.a)({},R,Object(k.a)({},e.target.name,e.target.value)))},T=function(){var e=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v("/auth/register","POST",Object(y.a)({},R));case 3:t=e.sent,i(a(t.message)),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var a=Object(h.a)(p.a.mark((function a(){var n;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v("/auth/login","POST",Object(y.a)({},R));case 3:n=a.sent,t.login(n.token,n.userId,n.userName),e.push("/create"),a.next=10;break;case 8:a.prev=8,a.t0=a.catch(0);case 10:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}();return l.a.createElement(m.a,{classNames:"item",in:N,timeout:1e3,mountOnEnter:!0,unmountOnExit:!0},l.a.createElement("div",{className:"container-fluid d-flex flex-column text-center"},l.a.createElement("div",{className:"row"},l.a.createElement("h2",{className:"pb-5 pt-5 col-12"},"AUTHORIZATION"),l.a.createElement("form",{className:"m-auto pb-5 col-12 col-sm-10 col-md-6 col-lg-6 col-xl-6"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"login"},"login"),l.a.createElement("input",{type:"login",className:"form-control",id:"login","aria-describedby":"emailHelp",name:"login",onChange:I,value:R.login})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"password"},"password"),l.a.createElement("input",{type:"password",className:"form-control",id:"password",name:"password",onChange:I,value:R.password})),l.a.createElement("div",{className:"mb-3"},u),l.a.createElement("button",{className:"btn btn-dark mb-2",style:{width:"100%"},disabled:b,onClick:A},"sign in"),l.a.createElement("button",{className:"btn btn-light",style:{width:"100%"},onClick:T,disabled:b},"sign up")))))},I=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useContext)(E).token,i=O(),d=i.request,b=i.loading,f=Object(n.useState)(null),v=Object(s.a)(f,2),j=v[0],x=v[1],N=Object(o.h)().id,w=Object(n.useCallback)(Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d("/covers/".concat(N),"GET",null,{Authorization:"Bearer ".concat(c)});case 3:return t=e.sent,e.next=6,x(t);case 6:r(!0),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])}))),[c,N,d]);return Object(n.useEffect)((function(){w()}),[w]),b?l.a.createElement("div",{className:"vh-100 d-flex align-items-center"},l.a.createElement(g,null)):l.a.createElement(m.a,{classNames:"item",in:a,timeout:1e3,mountOnEnter:!0,unmountOnExit:!0},l.a.createElement("div",{className:"container-fluid item"},l.a.createElement(u.b,{to:"/covers",type:"button",className:"btn btn-link text-dark"},l.a.createElement("svg",{className:"bi bi-arrow-left-short",width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},l.a.createElement("path",{fillRule:"evenodd",d:"M7.854 4.646a.5.5 0 010 .708L5.207 8l2.647 2.646a.5.5 0 01-.708.708l-3-3a.5.5 0 010-.708l3-3a.5.5 0 01.708 0z",clipRule:"evenodd"}),l.a.createElement("path",{fillRule:"evenodd",d:"M4.5 8a.5.5 0 01.5-.5h6.5a.5.5 0 010 1H5a.5.5 0 01-.5-.5z",clipRule:"evenodd"})),"go to the covers list"),!b&&!!j&&l.a.createElement("div",{className:"jumbotron"},l.a.createElement("img",{src:j.filedataName,className:"mw-100 bord",style:{borderRadius:".3rem"},alt:""}),l.a.createElement("hr",null),l.a.createElement("h1",{className:"display-4"},"author: ",j.author),l.a.createElement("hr",null),l.a.createElement("p",{className:"lead"},"label: ",j.label),l.a.createElement("p",null,"genre: ",j.genre),l.a.createElement("p",null,"date: ",j.date))))},T=function(e){return e?l.a.createElement(o.d,null,l.a.createElement(o.b,{path:"/",exact:!0},l.a.createElement(d,null)),l.a.createElement(o.b,{path:"/covers",exact:!0},l.a.createElement(w,null)),l.a.createElement(o.b,{path:"/create",exact:!0},l.a.createElement(R,null)),l.a.createElement(o.b,{path:"/detail/:id"},l.a.createElement(I,null)),l.a.createElement(o.a,{to:"/"})):l.a.createElement(o.d,null,l.a.createElement(o.b,{path:"/",exact:!0},l.a.createElement(d,null)),l.a.createElement(o.b,{path:"/covers",exact:!0},l.a.createElement(w,null)),l.a.createElement(o.b,{path:"/auth",exact:!0},l.a.createElement(z,null)),l.a.createElement(o.b,{path:"/detail/:id"},l.a.createElement(I,null)),l.a.createElement(o.a,{to:"/"}))};a(42),a(43);var A=function(){var e=i(),t=e.token,a=e.login,n=e.logout,r=e.userId,c=e.ready,o=e.userName,s=!!t,m=T(s);return c?l.a.createElement(E.Provider,{value:{token:t,login:a,logout:n,userId:r,isAuthenticated:s}},l.a.createElement(u.a,null,l.a.createElement("span",{style:{position:"absolute",right:"0",padding:".375rem .75rem"}},"hi, ",o,"!"),m)):l.a.createElement(g,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.b3de7390.chunk.js.map